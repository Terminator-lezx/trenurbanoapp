delete from ref.subroute where route = 'HR' and direction = 'HOSPITAL';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.032334 18.235034,-66.031877 18.235038,-66.031749 18.235322,-66.030735 18.235051,-66.031324 18.233574,-66.031505 18.233171,-66.031832 18.232466,-66.031912 18.232384,-66.032211 18.232007,-66.03301 18.23034,-66.034564 18.228074,-66.034857 18.22758,-66.034906 18.227411,-66.034944 18.227254,-66.035028 18.227115,-66.035145 18.227022,-66.035421 18.226531,-66.035528 18.226415,-66.03572 18.226347,-66.035952 18.226364,-66.036416 18.226563,-66.036799 18.226724,-66.037118 18.226879,-66.037335 18.226863,-66.039676 18.222582,-66.04116 18.219905,-66.04127 18.219754,-66.041388 18.219609,-66.041474 18.21947,-66.041583 18.219278,-66.042243 18.218364,-66.042941 18.217368,-66.043365 18.216768,-66.043505 18.21657,-66.043588 18.216508,-66.04364 18.216514,-66.044252 18.216903,-66.044739 18.217345,-66.045 18.217847,-66.045058 18.217941,-66.045142 18.217962,-66.045194 18.217948,-66.046133 18.217468,-66.048054 18.216499,-66.049366 18.215818,-66.049502 18.215804,-66.0496 18.215903,-66.049614 18.216026,-66.049556 18.216116,-66.049395 18.216217,-66.048862 18.216502,-66.048727 18.216636,-66.048658 18.216775,-66.048652 18.216978,-66.048779 18.217325,-66.048859 18.217572,-66.048868 18.217955,-66.048911 18.218721,-66.048943 18.219055,-66.049032 18.219681,-66.048969 18.219999,-66.048845 18.220264,-66.048828 18.220382,-66.048897 18.220483,-66.048989 18.220505,-66.049257 18.220363)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'HR','HOSPITAL', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute where route = 'HR' and direction = 'TERM_CAGUAS';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.049375 18.2203,-66.049626 18.220135,-66.049692 18.219996,-66.049646 18.219859,-66.049594 18.219769,-66.0493 18.219252,-66.049156 18.21888,-66.049024 18.218321,-66.048926 18.217864,-66.04888 18.217563,-66.048831 18.217369,-66.048685 18.216994,-66.048684 18.216804,-66.04875 18.216654,-66.048888 18.216521,-66.0494 18.216276,-66.049604 18.216157,-66.04967 18.216005,-66.049656 18.215863,-66.049595 18.215741,-66.049518 18.215707,-66.049411 18.215721,-66.048031 18.21646,-66.046111 18.217428,-66.045161 18.217891,-66.045109 18.217911,-66.045073 18.21788,-66.045021 18.217797,-66.04477 18.217329,-66.044706 18.217272,-66.044259 18.216872,-66.043646 18.216476,-66.043505 18.216447,-66.043373 18.216491,-66.043213 18.216692,-66.041745 18.218791,-66.041496 18.219094,-66.041367 18.219229,-66.041205 18.219378,-66.041116 18.219494,-66.041049 18.219669,-66.041012 18.219835,-66.040977 18.219932,-66.039634 18.222561,-66.037328 18.226743,-66.037129 18.227145,-66.036432 18.228407,-66.036162 18.228931,-66.035612 18.230205,-66.035167 18.231265,-66.035111 18.231277,-66.034879 18.231252,-66.034417 18.231325,-66.03431 18.231827,-66.034118 18.232441,-66.033969 18.232988,-66.03373 18.233717,-66.033503 18.234387,-66.033422 18.234439,-66.033222 18.234863,-66.033119 18.235035,-66.032763 18.234988,-66.032448 18.235016)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'HR','TERM_CAGUAS', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute_stop where route = 'HR' and direction = 'TERM_CAGUAS'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8021, 0, 'HR', 'TERM_CAGUAS'),(8000, 1, 'HR', 'TERM_CAGUAS');
delete from ref.subroute_stop where route = 'HR' and direction = 'HOSPITAL'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8000, 0, 'HR', 'HOSPITAL'),(8021, 1, 'HR', 'HOSPITAL');
