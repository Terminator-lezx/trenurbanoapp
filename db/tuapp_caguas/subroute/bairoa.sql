delete from ref.subroute where route = 'BA' and direction = 'TERM_CAGUAS';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.014077 18.277557,-66.013204 18.277825,-66.012898 18.277804,-66.012582 18.277714,-66.012349 18.277565,-66.012064 18.27721,-66.011928 18.277136,-66.011678 18.277059,-66.011121 18.277015,-66.010866 18.276921,-66.009538 18.27601,-66.009338 18.275843,-66.009231 18.275649,-66.008836 18.274204,-66.008838 18.273442,-66.00889 18.27302,-66.008853 18.27232,-66.009049 18.271911,-66.009409 18.271644,-66.009836 18.271141,-66.009993 18.270771,-66.010137 18.268996,-66.010041 18.268707,-66.009676 18.268192,-66.009628 18.267986,-66.009732 18.26748,-66.010037 18.266901,-66.010283 18.266683,-66.010911 18.266265,-66.012239 18.265462,-66.012539 18.265326,-66.014195 18.264778,-66.017095 18.264395,-66.017319 18.264281,-66.017885 18.263807,-66.018558 18.263347,-66.019494 18.262944,-66.020251 18.262707,-66.023044 18.262066,-66.025003 18.261529,-66.025789 18.261035,-66.02596 18.260858,-66.026402 18.26055,-66.027731 18.259313,-66.027775 18.259144,-66.027678 18.258272,-66.027725 18.258191,-66.029343 18.25758,-66.030745 18.256441,-66.030918 18.256343,-66.031558 18.256237,-66.033636 18.256137,-66.034503 18.256316,-66.035177 18.256603,-66.035337 18.256631,-66.035842 18.256456,-66.036385 18.256368,-66.036492 18.256295,-66.035396 18.239937,-66.035466 18.239615,-66.035597 18.239348,-66.036088 18.238972,-66.036613 18.238405,-66.036927 18.238018,-66.036945 18.237917,-66.036332 18.237348,-66.036131 18.23709,-66.036108 18.236969,-66.036255 18.236334,-66.036234 18.236271,-66.033244 18.235142,-66.033161 18.235054,-66.033209 18.234871,-66.032744 18.234687,-66.03251 18.234626,-66.032386 18.234652,-66.032038 18.234552,-66.031897 18.234878)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'BA','TERM_CAGUAS', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute where route = 'BA' and direction = 'BAIROA';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.031847 18.235033,-66.031736 18.235393,-66.032759 18.235759,-66.032977 18.235735,-66.035065 18.236526,-66.035416 18.242643,-66.03585 18.249002,-66.035872 18.249607,-66.035832 18.249775,-66.035892 18.250886,-66.036112 18.254148,-66.036247 18.254762,-66.036368 18.256182,-66.036338 18.256265,-66.036292 18.256317,-66.035885 18.256388,-66.035341 18.256565,-66.034432 18.256249,-66.033583 18.256093,-66.031437 18.256201,-66.030856 18.256313,-66.029318 18.257541,-66.027678 18.258151,-66.027638 18.258349,-66.027726 18.259192,-66.027646 18.25933,-66.026349 18.260534,-66.025528 18.261117,-66.024882 18.261482,-66.023175 18.261964,-66.02024 18.262673,-66.019481 18.26291,-66.018539 18.263316,-66.017853 18.263785,-66.017296 18.264252,-66.017084 18.264361,-66.014207 18.264729,-66.012523 18.265284,-66.012215 18.265423,-66.010807 18.266277,-66.010253 18.266648,-66.01 18.266872,-66.009687 18.267464,-66.00958 18.267989,-66.009632 18.26821,-66.01 18.268729,-66.01009 18.269004,-66.009956 18.270734,-66.009798 18.271114,-66.009379 18.271611,-66.009014 18.271881,-66.008806 18.272315,-66.008843 18.27302,-66.008786 18.273542,-66.008789 18.274211,-66.009187 18.275664,-66.009302 18.275873,-66.009527 18.276061,-66.010843 18.276961,-66.011111 18.277059,-66.01167 18.277104,-66.011906 18.277176,-66.012079 18.277303,-66.012305 18.277587,-66.012563 18.277755,-66.012889 18.277848,-66.013208 18.27787,-66.014089 18.2776)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'BA','BAIROA', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute_stop where route = 'BA' and direction = 'BAIROA'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8000, 0, 'BA', 'BAIROA'),(8025, 1, 'BA', 'BAIROA');
delete from ref.subroute_stop where route = 'BA' and direction = 'TERM_CAGUAS'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8025, 0, 'BA', 'TERM_CAGUAS'),(8000, 1, 'BA', 'TERM_CAGUAS');
