delete from ref.subroute where route = 'BM' and direction = 'TERM_CAGUAS';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.071124 18.268202,-66.071158 18.268192,-66.071173 18.268182,-66.071176 18.268166,-66.071168 18.268153,-66.071149 18.268145,-66.07111 18.268145,-66.071058 18.268151,-66.070984 18.268156,-66.070895 18.268153,-66.070864 18.268151,-66.070786 18.268144,-66.070685 18.268126,-66.070649 18.268119,-66.070538 18.268097,-66.070509 18.268093,-66.070336 18.268067,-66.070197 18.268046,-66.07019 18.268044,-66.070171 18.268041,-66.069997 18.26803,-66.069971 18.268029,-66.069914 18.268024,-66.069787 18.268013,-66.069623 18.268001,-66.069488 18.267999,-66.069312 18.268012,-66.069171 18.268031,-66.06903 18.268058,-66.069003 18.268064,-66.068905 18.268085,-66.068735 18.26812,-66.068641 18.268143,-66.06862 18.268148,-66.068617 18.268149,-66.068515 18.26817,-66.068397 18.268199,-66.068248 18.26823,-66.068173 18.268249,-66.068034 18.268286,-66.0679 18.268327,-66.067873 18.268335,-66.067801 18.268362,-66.067731 18.268418,-66.067628 18.268528,-66.067546 18.268614,-66.067484 18.268671,-66.067425 18.268697,-66.067353 18.268715,-66.067242 18.26871,-66.067054 18.268667,-66.06672 18.268598,-66.06643 18.26853,-66.066339 18.268498,-66.066312 18.268481,-66.066286 18.268464,-66.066174 18.268375,-66.066028 18.268235,-66.066017 18.268226,-66.065962 18.268176,-66.065934 18.268151,-66.065916 18.268129,-66.065906 18.268119,-66.065892 18.268114,-66.065874 18.268111,-66.065838 18.268101,-66.065816 18.268101,-66.065793 18.268101,-66.065758 18.2681,-66.065751 18.268099,-66.065714 18.268099,-66.065664 18.268099,-66.0656 18.26811,-66.065505 18.268129,-66.065504 18.268129,-66.065362 18.268162,-66.065296 18.268177,-66.065231 18.268191,-66.065081 18.268218,-66.06494 18.268245,-66.064827 18.268259,-66.064808 18.268262,-66.064684 18.268271,-66.064553 18.268277,-66.064491 18.268271,-66.064487 18.26827,-66.064401 18.268262,-66.064284 18.268252,-66.064141 18.268241,-66.06401 18.268234,-66.063902 18.268221,-66.063838 18.268212,-66.063802 18.2682,-66.063753 18.268185,-66.063694 18.268161,-66.063679 18.268148,-66.063594 18.268074,-66.063581 18.268061,-66.063556 18.268036,-66.063519 18.267999,-66.063467 18.267949,-66.063419 18.267902,-66.063309 18.267799,-66.063178 18.267669,-66.063081 18.267594,-66.062999 18.26755,-66.062971 18.267544,-66.06292 18.267533,-66.062823 18.267535,-66.062734 18.267543,-66.062681 18.267548,-66.062529 18.267571,-66.062452 18.267595,-66.062323 18.267635,-66.061994 18.267764,-66.061958 18.267778,-66.0617 18.267901,-66.061633 18.267932,-66.061403 18.268038,-66.061368 18.268054,-66.061135 18.268167,-66.061116 18.268175,-66.06087 18.268272,-66.060687 18.268348,-66.060631 18.268367,-66.060515 18.268407,-66.060375 18.268447,-66.060341 18.268455,-66.060239 18.268481,-66.060122 18.268504,-66.059992 18.268519,-66.059845 18.268531,-66.05983 18.268532,-66.059673 18.268541,-66.059615 18.268541,-66.059415 18.268541,-66.05921 18.268535,-66.0592 18.268536,-66.059048 18.268542,-66.058953 18.268558,-66.058879 18.268578,-66.058836 18.268595,-66.058782 18.268617,-66.058677 18.268675,-66.058563 18.268738,-66.058441 18.268798,-66.058335 18.268834,-66.058282 18.26884,-66.058179 18.268844,-66.058141 18.268853,-66.058113 18.268858,-66.058059 18.268866,-66.057881 18.268895,-66.057694 18.268924,-66.057541 18.268952,-66.05745 18.268987,-66.057441 18.268992,-66.057428 18.269001,-66.057364 18.26904,-66.057305 18.269102,-66.057264 18.269168,-66.057227 18.269272,-66.0572 18.269389,-66.057162 18.269607,-66.057147 18.269721,-66.057125 18.269879,-66.057063 18.270218,-66.057041 18.270365,-66.057023 18.270484,-66.057014 18.270543,-66.056974 18.270808,-66.056964 18.270942,-66.05696 18.270967,-66.05696 18.270986,-66.056962 18.271007,-66.05697 18.271032,-66.056982 18.271063,-66.057008 18.271096,-66.057038 18.271125,-66.057081 18.27115,-66.057106 18.271165,-66.057107 18.271165,-66.057225 18.271209,-66.057364 18.271241,-66.057388 18.271247,-66.057518 18.271271,-66.057655 18.27129,-66.057768 18.27131,-66.057842 18.271325,-66.057988 18.271352,-66.058132 18.271387,-66.058261 18.271421,-66.058265 18.271423,-66.058356 18.271457,-66.058472 18.271524,-66.058582 18.271602,-66.058658 18.271658,-66.058748 18.271708,-66.058873 18.271762,-66.058919 18.271781,-66.059043 18.271832,-66.059207 18.271883,-66.059325 18.271935,-66.05935 18.271946,-66.059455 18.272016,-66.059537 18.272101,-66.059598 18.272191,-66.059689 18.272325,-66.059743 18.272433,-66.059755 18.272456,-66.059805 18.272561,-66.059866 18.272708,-66.059875 18.27273,-66.059951 18.272975,-66.059994 18.27314,-66.060041 18.273346,-66.060046 18.273409,-66.060081 18.273554,-66.060116 18.273641,-66.060128 18.273671,-66.060149 18.273727,-66.060186 18.273851,-66.06021 18.273929,-66.060264 18.274095,-66.060277 18.274137,-66.060316 18.274256,-66.060357 18.274402,-66.060368 18.274516,-66.060369 18.274528,-66.060351 18.27462,-66.06031 18.274722,-66.060237 18.274834,-66.060152 18.274943,-66.060035 18.275092,-66.05999 18.27515,-66.059894 18.275271,-66.059894 18.275272,-66.059732 18.275457,-66.059609 18.2756,-66.059535 18.275693,-66.059484 18.275757,-66.059391 18.275859,-66.059295 18.275921,-66.059218 18.275958,-66.059127 18.275975,-66.059044 18.275979,-66.058958 18.275963,-66.058949 18.275961,-66.05887 18.275925,-66.058739 18.275843,-66.058621 18.275775,-66.058519 18.275743,-66.058379 18.275731,-66.05826 18.275768,-66.058166 18.275829,-66.058099 18.275935,-66.058026 18.276064,-66.058013 18.276086,-66.057904 18.276286,-66.057895 18.276304,-66.057832 18.276408,-66.057744 18.276521,-66.057688 18.276617,-66.057413 18.276947,-66.057374 18.277003,-66.057245 18.277249,-66.057231 18.277362,-66.057239 18.277494,-66.057272 18.277554,-66.057315 18.27761,-66.057363 18.277648,-66.057425 18.27768,-66.057608 18.277674,-66.057799 18.277598,-66.058245 18.277395,-66.058329 18.277365,-66.058543 18.277365,-66.058685 18.277417,-66.058795 18.277503,-66.059096 18.277888,-66.059133 18.277956,-66.059153 18.278065,-66.059153 18.278154,-66.059139 18.278277,-66.059068 18.278592,-66.05905 18.278656,-66.059045 18.278839,-66.059075 18.279027,-66.059108 18.279615,-66.059065 18.279706,-66.059019 18.279753,-66.058896 18.279809,-66.058756 18.27987,-66.058643 18.279798,-66.058507 18.279627,-66.058427 18.279565,-66.058337 18.279511,-66.058207 18.279475,-66.058053 18.279478,-66.057914 18.279513,-66.057662 18.279682,-66.057455 18.279851,-66.057228 18.280019,-66.057032 18.280108,-66.05691 18.280146,-66.056721 18.280188,-66.05648 18.280209,-66.05628 18.280228,-66.055885 18.280198,-66.055762 18.280227,-66.055686 18.280261,-66.055613 18.280345,-66.055467 18.280457,-66.05533 18.280523,-66.055103 18.280535,-66.054936 18.280558,-66.054576 18.280664,-66.054143 18.28092,-66.054026 18.280952,-66.053674 18.280963,-66.053378 18.28103,-66.053133 18.28112,-66.052702 18.281316,-66.052287 18.28146,-66.051576 18.281567,-66.051394 18.281479,-66.05113 18.281172,-66.050929 18.28098,-66.050804 18.2809,-66.05065 18.280851,-66.050463 18.280821,-66.050205 18.28085,-66.04982 18.280957,-66.04966 18.281005,-66.049524 18.281025,-66.049354 18.281025,-66.048819 18.280947,-66.048352 18.281004,-66.047913 18.281069,-66.047594 18.281117,-66.047167 18.281204,-66.046981 18.281248,-66.046861 18.281264,-66.046612 18.281248,-66.046198 18.28121,-66.045893 18.281214,-66.045747 18.281215,-66.045655 18.281192,-66.045607 18.281132,-66.045582 18.281052,-66.045602 18.280836,-66.045707 18.280549,-66.045666 18.280197,-66.045549 18.280038,-66.045419 18.279907,-66.045316 18.279845,-66.04517 18.27981,-66.044496 18.279893,-66.044333 18.279935,-66.044085 18.280041,-66.043872 18.280147,-66.043397 18.280536,-66.043216 18.280575,-66.042638 18.280642,-66.042499 18.280533,-66.041965 18.277726,-66.041906 18.277425,-66.041503 18.275022,-66.041428 18.274573,-66.041332 18.274078,-66.041247 18.273171,-66.041067 18.272403,-66.040823 18.271558,-66.040597 18.270867,-66.040041 18.268977,-66.039465 18.267067,-66.038354 18.263159,-66.038278 18.262837,-66.037948 18.261826,-66.037808 18.261405,-66.037533 18.260441,-66.037245 18.259491,-66.036967 18.258475,-66.036849 18.258006,-66.036688 18.257256,-66.036553 18.256495,-66.03642 18.255185,-66.036366 18.254648,-66.036334 18.253936,-66.035837 18.246462,-66.035737 18.244966,-66.035627 18.243314,-66.035473 18.241293,-66.035425 18.240734,-66.035397 18.240146,-66.035392 18.240022,-66.035397 18.239854,-66.035428 18.239655,-66.035496 18.239438,-66.035531 18.239222,-66.035525 18.239142,-66.035302 18.238535,-66.035253 18.238372,-66.03514 18.236561,-66.03514 18.236423,-66.035292 18.235975,-66.035297 18.235945,-66.035283 18.235922,-66.035236 18.235895,-66.034445 18.235616,-66.034081 18.235483,-66.033242 18.235139,-66.033199 18.235115,-66.033165 18.235083,-66.033161 18.235039,-66.033182 18.234971,-66.033202 18.234902,-66.033188 18.234852,-66.033138 18.234821,-66.032526 18.234625,-66.03247 18.234629,-66.032407 18.234662,-66.032362 18.234653,-66.032077 18.234557,-66.032025 18.234564,-66.031917 18.234877)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'BM','TERM_CAGUAS', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute where route = 'BM' and direction = 'BO_LAMESA';with line_tmp as (select ST_Transform(ST_GeomFromEWKT('SRID=4326;LINESTRING(-66.03189 18.234946,-66.031745 18.235378,-66.031752 18.235399,-66.032721 18.235741,-66.032802 18.235768,-66.032866 18.235762,-66.032938 18.235737,-66.032977 18.235738,-66.033872 18.236061,-66.033935 18.236096,-66.034556 18.236324,-66.035025 18.236495,-66.035068 18.236526,-66.035082 18.236603,-66.035175 18.238168,-66.035177 18.23832,-66.035184 18.238631,-66.035215 18.239216,-66.035247 18.239705,-66.035275 18.240162,-66.035315 18.240711,-66.035571 18.244759,-66.035687 18.246479,-66.036187 18.253834,-66.036255 18.254697,-66.036296 18.255167,-66.036445 18.256498,-66.036563 18.257307,-66.036735 18.258012,-66.036871 18.258564,-66.037145 18.259499,-66.037428 18.260462,-66.037699 18.261426,-66.03777 18.26167,-66.03815 18.262942,-66.038209 18.263135,-66.0388 18.265144,-66.039363 18.26709,-66.039941 18.269043,-66.040504 18.270988,-66.040718 18.271762,-66.040933 18.272536,-66.041054 18.273197,-66.041276 18.274088,-66.041372 18.274582,-66.041447 18.27503,-66.04185 18.277435,-66.041909 18.277735,-66.042412 18.280574,-66.042512 18.280679,-66.04261 18.28069,-66.043254 18.280617,-66.043413 18.280566,-66.043911 18.280152,-66.044096 18.280055,-66.044343 18.279968,-66.044496 18.279918,-66.045165 18.279837,-66.045307 18.279871,-66.045386 18.279923,-66.045502 18.280062,-66.045622 18.280221,-66.045668 18.280551,-66.045578 18.280803,-66.04555 18.281073,-66.045585 18.281158,-66.045633 18.281217,-66.045738 18.281239,-66.045901 18.281238,-66.0462 18.281234,-66.046622 18.28127,-66.046872 18.281289,-66.046997 18.281273,-66.047178 18.281222,-66.047594 18.28114,-66.0479 18.281092,-66.048356 18.281029,-66.048831 18.280968,-66.049349 18.281052,-66.049521 18.281054,-66.049663 18.281028,-66.049824 18.280977,-66.050217 18.280872,-66.050465 18.280846,-66.050649 18.28087,-66.050792 18.280927,-66.050912 18.280993,-66.051098 18.281194,-66.05137 18.281514,-66.051574 18.281595,-66.052297 18.281482,-66.052713 18.281338,-66.053137 18.281139,-66.053387 18.281048,-66.053667 18.280988,-66.054026 18.280978,-66.054152 18.280945,-66.054582 18.280686,-66.054936 18.280581,-66.055114 18.28055,-66.055338 18.28054,-66.055488 18.280471,-66.055633 18.280352,-66.055701 18.28028,-66.055803 18.280243,-66.055888 18.280219,-66.05629 18.280242,-66.05648 18.280233,-66.056725 18.280206,-66.056906 18.280173,-66.057047 18.280133,-66.057239 18.280041,-66.057482 18.279857,-66.057686 18.27969,-66.057917 18.27953,-66.05806 18.279496,-66.058204 18.279496,-66.058332 18.27953,-66.058413 18.279583,-66.058491 18.279642,-66.058632 18.279811,-66.058703 18.27987,-66.058816 18.279902,-66.058912 18.279885,-66.059054 18.279797,-66.059111 18.279725,-66.059149 18.279642,-66.059166 18.279562,-66.059153 18.279323,-66.059096 18.279024,-66.059073 18.278828,-66.059083 18.278707,-66.059093 18.278602,-66.059162 18.278269,-66.059179 18.278065,-66.059154 18.277947,-66.05899 18.277704,-66.058817 18.277483,-66.058684 18.277395,-66.058553 18.277338,-66.058323 18.277346,-66.058238 18.277375,-66.057783 18.277576,-66.057597 18.277645,-66.05745 18.277652,-66.057387 18.277626,-66.057334 18.277581,-66.057274 18.277475,-66.057266 18.277366,-66.057274 18.277259,-66.057396 18.277027,-66.057471 18.276958,-66.057506 18.276929,-66.05761 18.276793,-66.057674 18.276705,-66.057691 18.276682,-66.057774 18.27654,-66.057861 18.276427,-66.057885 18.276389,-66.057926 18.276321,-66.057985 18.276211,-66.058044 18.276102,-66.05813 18.275952,-66.058192 18.275853,-66.058275 18.275799,-66.058383 18.275766,-66.058511 18.275777,-66.058606 18.275806,-66.05872 18.275872,-66.058852 18.275955,-66.058938 18.275993,-66.059041 18.276013,-66.059131 18.276009,-66.05923 18.27599,-66.059313 18.27595,-66.059414 18.275884,-66.059437 18.27586,-66.059512 18.275779,-66.059598 18.27567,-66.059637 18.275621,-66.05976 18.275479,-66.059921 18.275293,-66.060018 18.275171,-66.060093 18.275075,-66.06018 18.274963,-66.060267 18.274853,-66.060298 18.274804,-66.060341 18.274737,-66.060385 18.274629,-66.060405 18.274529,-66.060392 18.274396,-66.06035 18.274246,-66.060337 18.274207,-66.060298 18.274085,-66.060264 18.273982,-66.060244 18.273919,-66.060182 18.273717,-66.060116 18.273532,-66.06006 18.273243,-66.060047 18.273215,-66.060043 18.273197,-66.060034 18.273156,-66.060028 18.273132,-66.059985 18.272967,-66.059908 18.272719,-66.059838 18.272547,-66.059825 18.27252,-66.059784 18.272401,-66.059713 18.27228,-66.059661 18.272221,-66.059628 18.272172,-66.059566 18.27208,-66.059533 18.272047,-66.059478 18.271991,-66.059367 18.271916,-66.05922 18.271852,-66.059056 18.2718,-66.058902 18.271737,-66.058887 18.271731,-66.058764 18.271678,-66.058678 18.271629,-66.058604 18.271575,-66.058548 18.271535,-66.058492 18.271496,-66.058372 18.271427,-66.058273 18.271389,-66.058141 18.271354,-66.057996 18.271319,-66.057849 18.271291,-66.057796 18.271281,-66.057581 18.271246,-66.057524 18.271238,-66.057396 18.271214,-66.057278 18.271185,-66.057221 18.271165,-66.057205 18.271158,-66.057154 18.271138,-66.057121 18.271123,-66.057074 18.271085,-66.057034 18.271027,-66.057021 18.270991,-66.057011 18.27093,-66.057016 18.270879,-66.05703 18.270736,-66.057045 18.270641,-66.057065 18.270481,-66.057071 18.270427,-66.057107 18.270203,-66.057119 18.27013,-66.057169 18.269852,-66.057201 18.269627,-66.057205 18.269601,-66.057216 18.269537,-66.057247 18.269366,-66.057262 18.269322,-66.057298 18.269221,-66.057327 18.269154,-66.057386 18.269091,-66.057451 18.269042,-66.057537 18.269,-66.057644 18.268974,-66.057787 18.268951,-66.05802 18.268922,-66.058063 18.268916,-66.058238 18.268902,-66.058348 18.268885,-66.05843 18.268862,-66.058454 18.268852,-66.058509 18.26883,-66.058623 18.268769,-66.058759 18.268699,-66.058807 18.268681,-66.058882 18.268652,-66.058968 18.268623,-66.059107 18.268597,-66.059223 18.268592,-66.059382 18.268593,-66.05961 18.268595,-66.059781 18.268596,-66.059798 18.268595,-66.059895 18.26859,-66.060031 18.26857,-66.060155 18.268552,-66.060267 18.268531,-66.060399 18.268501,-66.060483 18.268479,-66.060518 18.268469,-66.060634 18.268433,-66.060858 18.268354,-66.061043 18.268274,-66.061148 18.268225,-66.061201 18.2682,-66.061394 18.268116,-66.061642 18.268002,-66.061731 18.267961,-66.061986 18.267839,-66.062248 18.267737,-66.062347 18.267698,-66.062546 18.267637,-66.06269 18.267614,-66.062826 18.267602,-66.062913 18.2676,-66.062974 18.267613,-66.063042 18.267649,-66.063131 18.267718,-66.06326 18.267846,-66.063315 18.267898,-66.06337 18.26795,-66.063468 18.268046,-66.063545 18.268122,-66.063638 18.268203,-66.063639 18.268204,-66.063665 18.268231,-66.063702 18.268246,-66.063747 18.268263,-66.063765 18.268264,-66.063822 18.268273,-66.063823 18.268273,-66.063893 18.268283,-66.063948 18.26829,-66.064028 18.268298,-66.064137 18.268304,-66.064279 18.268315,-66.064394 18.268325,-66.064551 18.268341,-66.064689 18.268334,-66.064815 18.268325,-66.064951 18.268308,-66.065094 18.26828,-66.065244 18.268253,-66.065378 18.268224,-66.065519 18.268191,-66.065611 18.268173,-66.065722 18.268168,-66.065746 18.26817,-66.06577 18.268171,-66.0658 18.26818,-66.065829 18.268186,-66.065831 18.268187,-66.065863 18.268197,-66.065902 18.268225,-66.065917 18.268236,-66.065982 18.268284,-66.065985 18.268286,-66.066128 18.268423,-66.066244 18.268517,-66.066308 18.268558,-66.066409 18.268593,-66.066705 18.268663,-66.066725 18.268667,-66.066936 18.26871,-66.067039 18.268731,-66.067233 18.268776,-66.06736 18.268782,-66.067448 18.268759,-66.067523 18.268726,-66.067595 18.26866,-66.06768 18.268572,-66.067779 18.268465,-66.067817 18.268435,-66.067933 18.268386,-66.068054 18.268349,-66.068191 18.268313,-66.068267 18.268292,-66.068316 18.26828,-66.068434 18.268252,-66.068674 18.268195,-66.068958 18.268131,-66.069181 18.268089,-66.069345 18.268067,-66.069533 18.268058,-66.069696 18.268061,-66.069895 18.26807,-66.070062 18.268084,-66.070189 18.268097,-66.070259 18.268104,-66.070427 18.26813,-66.070581 18.268163,-66.070686 18.268183,-66.070813 18.268208,-66.070885 18.268221,-66.070941 18.268223,-66.071032 18.268218,-66.071092 18.268206)'), 32161) geom) insert into ref.subroute(route, direction, geom) select 'BM','BO_LAMESA', ST_AddMeasure(line_tmp.geom, 0, ST_Length(line_tmp.geom)) from line_tmp;
delete from ref.subroute_stop where route = 'BM' and direction = 'TERM_CAGUAS'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8004, 0, 'BM', 'TERM_CAGUAS'),(8000, 1, 'BM', 'TERM_CAGUAS');
delete from ref.subroute_stop where route = 'BM' and direction = 'BO_LAMESA'; insert into ref.subroute_stop (stop, stop_order, route, direction) values (8000, 0, 'BM', 'BO_LAMESA'),(8004, 1, 'BM', 'BO_LAMESA');
